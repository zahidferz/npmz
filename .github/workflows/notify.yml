name: notify

on:
  release:
    types: [published]
    
jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/setup-node@v2
        with:
          node-version: 16
      - run: |
          echo $GITHUB_REF_NAME
          curl -X POST --data-urlencode "payload={\"attachments\":[{\"fallback\":\"$GITLAB_USER_NAME released new $REPO_NAME version $GITHUB_REF_NAME\",\"color\":\"good\",\"title\":\"Version $GITHUB_REF_NAME of $REPO_NAME released\",\"title_link\":\"$CI_PROJECT_URL/-/tags/$GITHUB_REF_NAME\",\"fields\":[{\"title\":\"Tag\",\"value\":\"<$CI_PROJECT_URL/commits/$GITHUB_REF_NAME|$GITHUB_REF_NAME>\",\"short\":true},{\"title\":\"Commit\",\"value\":\"<$CI_PROJECT_URL/tree/$CI_COMMIT_SHA|$CI_COMMIT_TITLE>\",\"short\":true}],\"footer\":\"$REPO_NAME\",\"ts\":\"$( date +%s )\"}]}" https://hooks.slack.com/services/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	
        env:
          REPO_NAME: ${{ github.event.repository.name }}